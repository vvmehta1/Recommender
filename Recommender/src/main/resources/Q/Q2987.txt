 question  ,  "public  static  void  main(string[]  args)  {ctx  =  new  classpathxmlapplicationcontext(""flow.xml"");dataimporter  importer  =  (dataimporter)ctx.getbean(""myimporterbean"");try  {importer.startimport();}  catch  (exception  e)  {e.printstacktrace();}  finally  {ctx.close();}};  public  void  startimport()  throws  exception  {for  (item  item  :  items)  {gatewaybean.publish(item);thread.sleep(200);  //  yield  period}};  <gateway  default-request-channel=""inchannel""  service-interface=""gatewaybean""  /><splitter  input-channel=""inchannel""  output-channel=""splitchannel""  /><payload-type-router  input-channel=""splitchannel""><mapping  type=""item""  channel=""itemchannel""  /><mapping  type=""someotheritem""  channel=""anotherchannel""  /></payload-type-router><outbound-channel-adapter  channel=""itemchannel""  ref=""daobean""  method=""persist""  />"  ,i  have  a  selfexecut  jar  program  that  reli  heavili  on  spring  integr  the  problem  i  am  have  is  that  the  below  is  a  cutdown  version  of  the  code  im  use  i  can  suppli  more  codeconfigur  if  need  the  entri  point  is  a  main  method  which  bootstrap  spring  and  start  the  import  process  the  dataimport  contain  a  simpl  loop  that  fire  messag  to  a  spring  integr  gateway  this  deliv  an  activ  push  approach  to  the  flow  rather  than  the  common  approach  of  poll  for  data  this  is  where  my  problem  come  in  for  complet  the  flow  xml  look  someth  like  this  the  flow  start  and  process  item  effect  but  onc  the  startimport  loop  finish  the  main  thread  termin  and  tear  down  all  the  spring  integr  thread  immedi  this  result  in  a  race  condit  the  last  n  item  are  not  complet  process  when  the  program  termin  i  have  an  idea  of  maintain  a  refer  count  of  the  item  i  am  process  but  this  is  prove  to  be  quit  complic  sinc  the  flow  often  splitsrout  the  messag  to  multipl  servic  activ  mean  it  is  difficult  to  determin  if  each  item  has  finishedwhat  i  think  i  need  is  some  way  to  either  check  that  no  spring  bean  are  still  execut  or  to  flag  that  all  item  sent  to  the  gateway  have  been  complet  process  befor  termin  ,    objectvari  simplevari  simpleassignmentexpress  