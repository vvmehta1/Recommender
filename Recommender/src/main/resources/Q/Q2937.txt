 question  ,  "public  class  test1  {public  static  void  main(string[]  args)  throws  interruptedexception  {final  int  size  =  100;final  map<integer'  '  integer>  map  =  new  hashmap<integer'  '  integer>();map.put(1'  '  1);map.put(2'  '  2);map.put(3'  '  3);final  int[]  list  =  new  int[size];final  countdownlatch  start  =  new  countdownlatch(1);runnable  put  =  new  runnable()  {@overridepublic  void  run()  {try  {start.await();for  (int  i  =  4;  i  <  size;  i++)  {map.put(i'  '  i);}}  catch  (exception  ex)  {}}};runnable  iterate  =  new  runnable()  {@overridepublic  void  run()  {try  {start.await();int  i  =  0;for  (map.entry<integer'  '  integer>  e  :  map.entryset())  {list[i++]  =  e.getkey();thread.sleep(1);}}  catch  (exception  ex)  {ex.printstacktrace();}}};executorservice  e  =  executors.newfixedthreadpool(2);e.submit(put);e.submit(iterate);e.shutdown();start.countdown();thread.sleep(100);for  (int  i  =  0;  i  <  size;  i++)  {if  (list[i]  ==  0)  {system.out.println(""max  i  =  ""  +  i);break;}}}}"  ,  state  i  built  a  sampl  code  that  base  on  the  specif  is  suppos  to  fail  almost  immedi  and  throw  a  concurrentmodificationexcept  note  it  sometim  doe  not  fail  with  java  say  time  out  of  i  guess  it  has  to  do  with  thread  schedul  ie  the  runnabl  are  not  interleav  in  substanc  there  are  runnabl  task  run  in  parallel  a  countdownlatch  is  use  to  make  them  start  approxim  at  the  same  time  the  main  thread  then  check  how  mani  key  have  been  ad  to  the  arrayth  iter  fail  immediatelyth  whole  iter  goe  through  and  the  array  contain  all  the  ad  key  note  use  jdk  u  and  jdk  u  bit  version  on  an  x  machin  ,  objectmethodinvoc  actualmethodparamet  constant  constantinitializationstat  arraycreationstat  arrayvari  arraydatatyp  intdatatyp  simpleassignmentexpress  objectcreationstat  constructorcal  instancefield  simplevari  arrayel  postincrementexpress  instancefieldinitializationstat  ifstat  equalexpress  javalangsystemoutprintln  stringliter  stringdatatyp  stringaddit    simpleassignmentexpress     simpleassignmentexpress  